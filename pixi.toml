[workspace]
authors = ["Eugenio La Cava"]
channels = ["conda-forge","https://conda.modular.com/max-nightly/", "https://repo.prefix.dev/modular", "https://repo.prefix.dev/mojo", "https://repo.prefix.dev/modular-community"]
name = "mojo-practice"
platforms = ["linux-64"]
version = "0.1.0"

[tasks]
pre-tool-hook = "cd /home/uge/mfc-project/.claude/hooks && python pre_tool_use.py"
post-tool-hook = "cd /home/uge/mfc-project/.claude/hooks && python post_tool_use.py"
detect-gpu = "python scripts/detect_gpu.py"
install-gpu-deps = "python scripts/install_gpu_deps.py"

# Linting tasks
lint-code = "ruff check . && mypy . && bandit -r . -f json -o bandit-report.json || (cat bandit-report.json && exit 1)"
lint-yaml = "yamllint -c .yamllint.yml ."
lint-markdown = "mdformat --check ."
secrets-detect = "detect-secrets scan --all-files --disable-plugin AbsolutePathDetectorPlugin --disable-plugin Base64HighEntropyString --disable-plugin HexHighEntropyString"

[feature.amd.activation]
env = { LLVM_PATH = "/opt/rocm/llvm" }

[dependencies]
scipy = ">=1.16.0,<2"
matplotlib = ">=3.10.3,<4"
python = ">=3.12.11,<3.14"
numpy = ">=2.3.1,<3"
modular = "25.4.*"
magic = ">=8.3.486,<9"
tectonic = ">=0.15.0,<0.16"
optuna = ">=4.4.0,<5"
git-lfs = ">=3.7.0,<4"
seaborn = ">=0.13.2,<0.14"
gh = ">=2.76.0,<3"
mdformat = ">=0.7.22,<0.8"
pandoc = ">=3.7.0.2,<4"
pytest = ">=8.4.1,<9"
ruff = ">=0.12.4,<0.13"
mypy = ">=1.17.0,<2"
pandas = ">=2.3.1,<3"
nox = ">=2025.5.1,<2026"
pyyaml = ">=6.0.2,<7"
types-pyyaml = ">=6.0.12.20250516,<7"
yamllint = ">=1.37.1,<2"

streamlit = ">=1.47.1,<2"
plotly = ">=6.2.0,<7"

[feature.dev.dependencies]
pytest = ">=7.0.0"
pytest-cov = ">=4.0.0"
ruff = ">=0.1.0"
mypy = ">=1.0.0"
black = ">=22.0.0"
pre-commit = ">=2.0.0"
bandit = "*"
safety = "*"
twine = "*"
pip = "*"

[feature.dev.pypi-dependencies]
build = "*"
pip-audit = "*"
pytest-benchmark = "*"
detect-secrets = "*"
mdformat = "*"
pymupdf = "*"

[pypi-dependencies]
detect-secrets = ">=1.5.0, <2"
python-gitlab = ">=4.0.0"
ray = {version = ">=2.0.0", extras = ["tune"]}
scikit-optimize = ">=0.9.0"
# JAX with CPU fallback - GPU-specific versions in feature environments
jax = ">=0.4.20"
jaxlib = ">=0.4.20"

[feature.amd.pypi-dependencies]
# ROCm-specific JAX installation
jax = {version = ">=0.4.20,<=0.4.31", extras = ["rocm"]}
jaxlib = ">=0.4.20,<=0.4.31"

[feature.nvidia.pypi-dependencies]
# NVIDIA CUDA support packages
jax = {version = ">=0.4.20,<=0.4.31", extras = ["cuda12"]}
jaxlib = ">=0.4.20,<=0.4.31"
cupy-cuda12x = ">=12.0.0"
torch = ">=2.0.0"
nvidia-ml-py3 = ">=7.352.0"

[feature.nvidia.dependencies]
# NVIDIA CUDA runtime libraries
cuda-toolkit = ">=12.0"
cudnn = ">=8.0"

[environments]
dev = ["dev"]
nvidia = ["nvidia"]
amd = ["amd"]
rocm = ["amd"]
